/*
 * VenoBox - jQuery Plugin
 * version: 1.5.3
 * @requires jQuery
 *
 * Examples at http://lab.veno.it/venobox/
 * License: MIT License
 * License URI: https://github.com/nicolafranchini/VenoBox/blob/master/LICENSE
 * Copyright 2013-2015 Nicola Franchini - @nicolafranchini
 *
 */
!function(t){function a(){t.ajax({url:w,cache:!1}).done(function(a){g.html('<div class="vbox-inline">'+a+"</div>");var i=g.find("img"),e=i.length,o=0;e>0?i.each(function(a,i){t(this).one("load",function(){o++,o==e&&l(!0)}).each(function(){this.complete&&t(this).load()})}):l(!0)}).fail(function(){g.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>'),l(!0)})}function i(){g.html('<iframe class="venoframe" src="'+w+'"></iframe>'),l()}function e(t){var a=w.split("/"),i=a[a.length-1],e=t?"?autoplay=1":"";g.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder="0" src="https://player.vimeo.com/video/'+i+e+'"></iframe>'),l()}function o(t){var a=w.split("/"),i=a[a.length-1],e=t?"?autoplay=1":"";g.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://www.youtube.com/embed/'+i+e+'"></iframe>'),l()}function n(){g.html('<div class="vbox-inline">'+t(w).html()+"</div>"),l()}function r(){D=t(".vbox-content").find("img"),D.one("load",function(){l()}).each(function(){this.complete&&t(this).load()})}function l(a){a=a||!1,1!=a&&t(window).scrollTop(0),u.html(I),g.find(">:first-child").addClass("figlio"),t(".figlio").css("width",z).css("height",j).css("padding",b).css("background",v),G=g.outerHeight(),B=t(window).height(),B>G+80?(H=(B-G)/2,g.css("margin-top",H),g.css("margin-bottom",H)):(g.css("margin-top","40px"),g.css("margin-bottom","40px")),"undefined"!=typeof O&&t.isFunction(O)?g.animate({opacity:"1"},"slow",O(y,S,m,g,f,u)):g.animate({opacity:"1"},"slow")}function c(){t(".vbox-content").length&&("undefined"!=typeof V&&t.isFunction(V)&&V(y,S,m,g,f,u),G=g.height(),B=t(window).height(),B>G+80?(H=(B-G)/2,g.css("margin-top",H),g.css("margin-bottom",H)):(g.css("margin-top","40px"),g.css("margin-bottom","40px")))}var d,s,p,v,f,u,b,h,m,g,y,w,x,k,_,T,E,z,j,C,F,q,H,M,P,S,A,D,I,L,Q,X,B,G,J,K,N,O,R,U,V;t.fn.extend({venobox:function(l){var c={framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:!1,infinigall:!1,overlayclose:!0,pre_open_callback:void 0,post_open_callback:void 0,pre_close_callback:void 0,post_close_callback:void 0,post_resize_callback:void 0},H=t.extend(c,l);return this.each(function(){var l=t(this);return l.data("venobox")?!0:(l.addClass("vbox-item"),l.data("framewidth",H.framewidth),l.data("frameheight",H.frameheight),l.data("border",H.border),l.data("bgcolor",H.bgcolor),l.data("numeratio",H.numeratio),l.data("infinigall",H.infinigall),l.data("overlayclose",H.overlayclose),l.data("pre_open_callback",H.pre_open_callback),l.data("post_open_callback",H.post_open_callback),l.data("pre_close_callback",H.pre_close_callback),l.data("post_close_callback",H.post_close_callback),l.data("post_resize_callback",H.post_resize_callback),l.data("venobox",!0),s=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1,p=document.all&&!window.atob?!0:!1,void l.click(function(c){function D(){L=l.data("gall"),M=l.data("numeratio"),C=l.data("infinigall"),F=t('.vbox-item[data-gall="'+L+'"]'),F.length>1&&M===!0?(f.html(F.index(l)+1+" / "+F.length),f.show()):f.hide(),Q=F.eq(F.index(l)+1),X=F.eq(F.index(l)-1),l.attr(H.titleattr)?(I=l.attr(H.titleattr),u.show()):(I="",u.hide()),F.length>1&&C===!0?(J=!0,K=!0,Q.length<1&&(Q=F.eq(0)),F.index(l)<1&&(X=F.eq(F.index(F.length)))):(Q.length>0?(t(".vbox-next").css("display","block"),J=!0):(t(".vbox-next").css("display","none"),J=!1),F.index(l)>0?(t(".vbox-prev").css("display","block"),K=!0):(t(".vbox-prev").css("display","none"),K=!1))}function B(t){27===t.keyCode&&G()}function G(){if("undefined"!=typeof R&&t.isFunction(R)){var a=R(y,S,m,g,f,u);if(void 0!=a&&!a)return}t("body").unbind("keydown",B),p?S.animate({opacity:0},500,function(){S.remove(),t(".vwrap").children().unwrap(),t(window).scrollTop(-A),q=!1,l.focus()}):(S.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),S.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(a){a.target==a.currentTarget&&(S.remove(),s?(t(".vwrap").bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){t(".vwrap").children().unwrap(),t(window).scrollTop(-A)}),t(".vwrap").css("opacity","1")):(t(".vwrap").children().unwrap(),t(window).scrollTop(-A)),q=!1,l.focus())}),"undefined"!=typeof U&&t.isFunction(U)?S.animate({opacity:"0"},"slow",U(y,S,m,g,f,u)):S.animate({opacity:"0"},"slow"))}if(c.stopPropagation(),c.preventDefault(),N=l.data("pre_open_callback"),"undefined"!=typeof N&&t.isFunction(N)){var W=N(t(l));if(void 0!=W&&!W)return}l=t(this),P=l.data("overlay"),z=l.data("framewidth"),j=l.data("frameheight"),d=l.data("autoplay")||!1,b=l.data("border"),v=l.data("bgcolor"),J=!1,K=!1,q=!1,O=l.data("post_open_callback"),R=l.data("pre_close_callback"),U=l.data("post_close_callback"),V=l.data("post_resize_callback"),w=l.attr("href"),T=l.data("css")||"",A=t(window).scrollTop(),A=-A,t("body").wrapInner('<div class="vwrap"></div>'),vwrap=t(".vwrap"),h='<div class="vbox-overlay '+T+'" style="background:'+P+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>',t("body").append(h),S=t(".vbox-overlay"),m=t(".vbox-container"),g=t(".vbox-content"),f=t(".vbox-num"),u=t(".vbox-title"),y=t(l),g.html(""),g.css("opacity","0"),D(),S.css("min-height",t(window).outerHeight()),p?S.animate({opacity:1},250,function(){S.css({"min-height":t(window).outerHeight(),height:"auto"}),"iframe"==l.data("type")?i():"inline"==l.data("type")?n():"ajax"==l.data("type")?a():"vimeo"==l.data("type")?e(d):"youtube"==l.data("type")?o(d):(g.html('<img src="'+w+'">'),r())}):(S.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(c){c.target==c.currentTarget&&(S.css({"min-height":t(window).outerHeight(),height:"auto"}),"iframe"==l.data("type")?i():"inline"==l.data("type")?n():"ajax"==l.data("type")?a():"vimeo"==l.data("type")?e(d):"youtube"==l.data("type")?o(d):(g.html('<img src="'+w+'">'),r()))}),S.css("opacity","1")),s?vwrap.css({position:"fixed",top:A,opacity:"0"}).data("top",A):(vwrap.css({position:"fixed",top:A}).data("top",A),t(window).scrollTop(0));var Y={prev:function(){q||(q=!0,P=X.data("overlay"),z=X.data("framewidth"),j=X.data("frameheight"),b=X.data("border"),v=X.data("bgcolor"),w=X.attr("href"),d=X.data("autoplay"),I=X.attr(H.titleattr)?X.attr(H.titleattr):"",void 0===P&&(P=""),g.animate({opacity:0},500,function(){S.css("background",P),"iframe"==X.data("type")?i():"inline"==X.data("type")?n():"ajax"==X.data("type")?a():"youtube"==X.data("type")?o(d):"vimeo"==X.data("type")?e(d):(g.html('<img src="'+w+'">'),r()),l=X,D(),q=!1}))},next:function(){q||(q=!0,P=Q.data("overlay"),z=Q.data("framewidth"),j=Q.data("frameheight"),b=Q.data("border"),v=Q.data("bgcolor"),w=Q.attr("href"),d=Q.data("autoplay"),I=Q.attr(H.titleattr)?Q.attr(H.titleattr):"",void 0===P&&(P=""),g.animate({opacity:0},500,function(){S.css("background",P),"iframe"==Q.data("type")?i():"inline"==Q.data("type")?n():"ajax"==Q.data("type")?a():"youtube"==Q.data("type")?o(d):"vimeo"==Q.data("type")?e(d):(g.html('<img src="'+w+'">'),r()),l=Q,D(),q=!1}))}};t("body").keydown(function(t){37==t.keyCode&&1==K&&Y.prev(),39==t.keyCode&&1==J&&Y.next()}),t(".vbox-prev").click(function(){Y.prev()}),t(".vbox-next").click(function(){Y.next()});var Z=".vbox-overlay";return l.data("overlayclose")||(Z=".vbox-close"),t(Z).click(function(a){x=".figlio",_=".vbox-prev",k=".vbox-next",E=".figlio *",t(a.target).is(x)||t(a.target).is(k)||t(a.target).is(_)||t(a.target).is(E)||G()}),t("body").keydown(B),!1}))})}}),t(window).resize(function(){c()})}(jQuery);